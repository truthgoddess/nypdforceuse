language: node_js
node_js:
  - 12 # uses version 12
services:
  - postgresql # starts up postgres
addons:
  postgresql: '10' # recent postgres version on Travis
dist: xenial # uses xenial environment
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "nypdforceuse-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)
script:
  - npm test # test the code
  - npm run build-client # make the bundle
before_deploy: # omit node_modules, since we set skip_cleanup below
  - rm -rf node_modules
deploy: # see README for details on these keys
  # prevents travis from deleting the build
  skip_cleanup: true
  provider: heroku
  # app should be your heroku app name; see README
  app: nypd-force-use
  # the secure key indicates an encrypted value; see README
  api_key:

    secure: qZWTrwqcqTXAkBaMMJNmifQ6sMF6W0X1XuiFwvDDSPHXdcYbbWkKH7KnxN1edEaybBr4b6k//nx1sjvOT50itpBq3qNsO+hlnHOcnVhO8O5IcZ1xM0UJaHHyctTLdCBnH/Z6d4gf946e2aiat/gvKA3ICXj4B+1JJ37Cgc3d+UnE7JNbwV97NfZw9E7hO7Q1YZ5nvD3QIMZaMcEfssz2XxyIsvhM15s5I3Bqf1EMswyuEmGE8VhHiEDDivMdXR3+ZWZYLjD4xobstv5dOvaDI/AoCap5T4j839tPgOF1+KsVCx50td2mlL4wYzCe9CzJLPKE9FEvaUExJpVueOWzbyvpocal2Qu4xGkTPqxbFHKQadQeg6L+dgZaLsSeGfv0fdjhcNNx5dUBRkmhk3aFgD/N7t34jivaJ39o+GHeQdFS6mgI5NuAMKyqzEgPtShjaFCA96Lytu9i9VoxGNaPdFv+6tdcdyOGqUUj6c5ENq86badiAt5gzIIWieOYSCsKJ2ImU4gjK+CZT45ui0V7k6P91T6mq48lqNBQNLM1St6OCeGfirGw/KUVGdmc2WpXdYcnYFy3RKtFHF5GDNg9jGzQ4A5pBfHTeXMnn1UEMVLnmb36mtQOXTCWjD0VsAnEIP6t73zFhSoUIvYPLaR0XbOMK9UjVw9DUbKLQBGSzus=

